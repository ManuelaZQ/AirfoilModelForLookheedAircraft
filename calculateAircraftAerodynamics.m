% calculateAircraftAerodynamics.m% function to calculate aircraft aerodynamic coefficients for wing, horizontal tail, and downwash effect% usage%   aircraft = calculateAircraftAerodynamics(aircraft)% where%   aircraft : aircraft data structure with the following fields%     * Aircraft general data:%       aircraft.aircraftName : aircraft name     %       aircraft.flightCondition : aircraft flight condition ('cruise')%       aircraft.type : type=1 for an aircraft with elevator and a fixed horizontal tail%                       type=2 for an aircraft with elevator and a adjustable horizontal tail%                       type=3 for an aircraft with adjustable horizontal tail without elevator%     * flight condition data%       aircraft.V : cruise speed (m/s)%       aircraft.h : cruise altitude (m)%       aircraft.m : aircraft mass (kg)%       aircraft.g : gravity (9.80665 m/s^2)%       aircraft.W : aircraft weight (N)%     * wing geometry%       aircraft.Sw : wing area (m^2)%       aircraft.bw : wing span (m)%       aircraft.cw : wing mean aerodynamic chord (m)%       aircraft.Aw : wing aspect ratio%       aircraft.xACw : wing aerodynamic center position respect to aircraft datum (m)%       aircraft.alpha0w : wing incidence (rad)%     * horizontal tail geometry%       aircraft.St : horizontal tail area (m^2)%       aircraft.bt : horizontal tail span (m)%       aircraft.ct : horizontal tail mean aerodynamic chord (m)%       aircraft.At : horizontal tail aspect ratio%       aircraft.xACt : horizontal tail aerodynamic center position respect to aircraft datum (m)%       aircraft.alpha0t : horizontal tail incidence (rad)% The result of the function is the same aircraft data structure with some additional fields%   aircraft : aircraft data structure with the fields described previously and the following additional fields%     * wing aerodynamic coefficients%       aircraft.CLwbalpha : wing-body lift coefficient slope%       aircraft.alphaL0wb : wing-body zero lift angle (rad)%       aircraft.CDwb0 : wing-body minimum drag coefficient%       aircraft.ewb : wing-body oswald number%       aircraft.Cmwb0 : wing-body moment coefficient respect to wing aerodynamic center%     * horizontal tail aerodynamic coefficients%       aircraft.CLtalpha : horizontal tail lift coefficient slope%       aircraft.alphaL0t : horizontal tail zero lift angle (rad)%       aircraft.epsilone : elevator effectiveness%       aircraft.CDt0 : horizontal tail minimum drag coefficient%       aircraft.et : horizontal tail oswald number%       aircraft.Cmt0 : horizontal tail moment coefficient respect to horizontal tail aerodynamic center%       aircraft.Cmtdeltae : elevator moment respect to horizontal tail aerodynamic center derivative%     * downwash effect%       aircraft.Kd : downwash constant%       aircraft.etat : tail efficiency%   function aircraft = calculateAircraftAerodynamics(aircraft)% Parameters of lifting line theory methodxCG = 14.62;alpha0lw = -2.5; % for NACA 0014alpha0lt = -1.13; % for NACA 23011numlocs = 100;alphaprobe = 10;%   Parameters of the wing-body coefficients[CL0wb, aircraft.CDwb0, aircraft.Cmwb0, ai, vy, aircraft.ewb] = LiftingLineTheory(aircraft.V, xCG, aircraft.xACw, 2*pi, aircraft.Aw, aircraft.lambdaw, alpha0lw, 0, aircraft.cw, numlocs);[CL, CDi, Cm, ai, w, e] = LiftingLineTheory(aircraft.V, xCG, aircraft.xACw, 2*pi, aircraft.Aw, aircraft.lambdaw, alpha0lw, alphaprobe, aircraft.cw, numlocs);aircraft.CLwbalpha = (CL - CL0wb)/deg2rad(alphaprobe);aircraft.alphaL0wb = -CL0wb/aircraft.CLwbalpha;%   Parameters of the tail coefficientVt = (aircraft.V^2+vy^2)^.5;Vt1 = (aircraft.V^2+w^2)^.5;[CL0t, aircraft.CDt0, aircraft.Cmt0, ai, w, aircraft.et] = LiftingLineTheory(Vt, xCG, aircraft.xACt, 2*pi, aircraft.At, aircraft.lambdat, alpha0lt, 0, aircraft.cw, numlocs);[CL, CDi, Cm, ai, w, e] = LiftingLineTheory(Vt1, xCG, aircraft.xACt, 2*pi, aircraft.At, aircraft.lambdat, alpha0lt, alphaprobe, aircraft.cw, numlocs);aircraft.CLtalpha = (CL - CL0t)/deg2rad(alphaprobe);aircraft.alphaL0t = -CL0t/aircraft.CLwbalpha;%cldeltae = 0.58; %aircraft.epsilone = cldeltae/aircraft.CLtalphadeltade = 15;deltacl = 1.206; aircraft.epsilone = deltacl/(aircraft.CLtalpha*deltade*pi/180);%aircraft.Cmtdeltae = -1.73;deltacm = -0.1568; aircraft.Cmtdeltae = deltacm/(deltade*pi/180);% downwash angleaircraft.Kd = vy*aircraft.Aw/aircraft.CLwbalpha;aircraft.etat = Vt^2/aircraft.V^2;end